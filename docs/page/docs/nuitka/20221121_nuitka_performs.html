<!DOCTYPE HTML>
<html lang="zh-cn" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>nuitka test - Difficult-Rocket-docs</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../update_logs.html"><strong aria-hidden="true">1.</strong> update logs</a></li><li class="chapter-item expanded "><a href="../contributors.html"><strong aria-hidden="true">2.</strong> contributors</a></li><li class="chapter-item expanded "><a href="../rua!.html"><strong aria-hidden="true">3.</strong> rua! 奇怪的东西</a></li><li class="chapter-item expanded "><a href="../nuitka/20221121_nuitka_performs.html" class="active"><strong aria-hidden="true">4.</strong> nuitka test</a></li><li class="chapter-item expanded "><a href="../plan_features/index.html"><strong aria-hidden="true">5.</strong> plan features</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../plan_features/格式.html"><strong aria-hidden="true">5.1.</strong> 格式</a></li><li class="chapter-item expanded "><a href="../plan_features/extra-save-info.html"><strong aria-hidden="true">5.2.</strong> 更多保存信息</a></li><li class="chapter-item expanded "><a href="../plan_features/multi-connect.html"><strong aria-hidden="true">5.3.</strong> 联机</a></li><li class="chapter-item expanded "><a href="../plan_features/multi-control.html"><strong aria-hidden="true">5.4.</strong> muit control</a></li></ol></li><li class="chapter-item expanded "><a href="../howto/index.html"><strong aria-hidden="true">6.</strong> how to</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../howto/client.html"><strong aria-hidden="true">6.1.</strong> client</a></li><li class="chapter-item expanded "><a href="../howto/mod/loader.html"><strong aria-hidden="true">6.2.</strong> mod loader</a></li><li class="chapter-item expanded "><a href="../howto/game/命名.html"><strong aria-hidden="true">6.3.</strong> game name</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Difficult-Rocket-docs</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="nuitka-121-的性能测试"><a class="header" href="#nuitka-121-的性能测试">nuitka 1.2.1 的性能测试</a></h1>
<p>大家好！ 这里是shenjack！
这篇文章就是 <a href="%E8%BF%98%E6%B2%A1%E5%8F%91%E5%87%BA%E6%9D%A5%E5%91%A2">B站</a> 专栏的原文！</p>
<h1 id="综述"><a class="header" href="#综述">综述</a></h1>
<h2 id="环境"><a class="header" href="#环境">环境</a></h2>
<ul>
<li>
<p>硬件</p>
<ul>
<li>CPU: <code>AMD R5 5600X</code></li>
<li>内存: <code>64G DDR4 3200 (32×2)</code></li>
</ul>
</li>
<li>
<p>软件</p>
<ul>
<li><img src="gcc_clang_version.png" alt="gcc clang" /></li>
<li><img src="python_nuitka_version.png" alt="python nuitka" /></li>
<li><img src="DR_git_commit.png" alt="DR" /></li>
<li><code>gcc 12.2.0</code></li>
<li><code>clang 14.0.6</code></li>
<li><code>nuitka v1.2.1</code></li>
<li><code>Python 3.8.10</code></li>
<li><a href="https://github.com/shenjackyuanjie/Difficult-Rocket">DR</a> commit <code>e6a2b7b36cc98e508efbc61c4646181f5817fc7c</code></li>
</ul>
</li>
</ul>
<h2 id="编译选项"><a class="header" href="#编译选项">编译选项</a></h2>
<ul>
<li>核心编译选项
<ul>
<li>
<p>环境</p>
<ul>
<li><code>--standalone</code>
<ul>
<li>将环境一并打包进完成的文件夹中</li>
<li>
<pre><code>--standalone Enable standalone mode for output. This allows you to
             transfer the created binary to other machines without
             it using an existing Python installation. This also
             means it will become big. It implies these option: &quot;--
             follow-imports&quot; and &quot;--python-flag=no_site&quot;. Defaults
             to off.```

</code></pre>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>编译器</p>
<ul>
<li><code>--clang</code>
<ul>
<li>强制使用 <code>clang</code> 编译器</li>
<li>
<pre><code>--clang Enforce the use of clang. On Windows this requires a
        working Visual Studio version to piggy back on.
        Defaults to off.```

</code></pre>
</li>
</ul>
</li>
<li><code>--mingw64</code> (常量)
<ul>
<li>强制使用 <code>mingw64</code> 编译器</li>
<li>
<pre><code>--mingw64 Enforce the use of MinGW64 on Windows. Defaults to
          off.```

</code></pre>
</li>
</ul>
</li>
<li><code>--jobs=24</code> (常量)
<ul>
<li>最多同时运行的 C 编译器 <code>(clang|mingw64)</code> 数量</li>
<li>
<pre><code> -j N, --jobs=N Specify the allowed number of parallel C compiler
                jobs. Defaults to the system CPU count.```

</code></pre>
</li>
</ul>
</li>
<li><code>--lto=</code> <code>yes|no|auto(None)</code>
<ul>
<li>是否启用 链接</li>
<li>
<pre><code>--lto=choice Use link time optimizations (MSVC, gcc, clang).
              Allowed values are &quot;yes&quot;, &quot;no&quot;, and &quot;auto&quot; (when it's
              known to work). Defaults to &quot;auto&quot;.```

</code></pre>
</li>
</ul>
</li>
<li><code>--disable-ccache</code>
<ul>
<li>不使用 <code>ccache</code> 或者 <code>clcache</code> 的缓存</li>
<li>
<pre><code>--disable-ccache Do not attempt to use ccache (gcc, clang, etc.) or
                 clcache (MSVC, clangcl).```


</code></pre>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="结论综述"><a class="header" href="#结论综述">结论综述</a></h2>
<p>补充：<code>lto=yes</code> 的情况下经常有报错</p>
<h3 id="有-ccache-全-hit-无实际编译"><a class="header" href="#有-ccache-全-hit-无实际编译">有 <code>Ccache</code> (全 hit 无实际编译)</a></h3>
<p><code>clang lto=no</code> 效率最高</p>
<p><code>mingw lto=no</code> 效率低于 <code>lto=yes</code>，但是更加稳定（不会报错）</p>
<h3 id="无-ccache-测试编译器实际效率"><a class="header" href="#无-ccache-测试编译器实际效率">无 <code>Ccache</code> (测试编译器实际效率)</a></h3>
<p><code>clang lto=no</code> 效率最高</p>
<p><code>mingw lto=no</code> 同样效率相对高</p>
<h3 id="总结"><a class="header" href="#总结">总结</a></h3>
<p>尽量使用 <code>lto=no</code> 配合 <code>ccache</code> 以及 <code>clang</code></p>
<h1 id="原始数据"><a class="header" href="#原始数据">原始数据</a></h1>
<h2 id="因为视频使用cpu编码所以很多数据没法看到这里使用的是后面再次测试微信群内存档的数据"><a class="header" href="#因为视频使用cpu编码所以很多数据没法看到这里使用的是后面再次测试微信群内存档的数据">因为视频使用CPU编码，所以很多数据没法看到，这里使用的是后面再次测试/微信群内存档的数据</a></h2>
<h2 id="视频应该会再次测试数据可能不同请谅解obs更新完没注意编码啊啊啊啊"><a class="header" href="#视频应该会再次测试数据可能不同请谅解obs更新完没注意编码啊啊啊啊">视频应该会再次测试，数据可能不同，请谅解(obs更新完没注意编码啊啊啊啊)</a></h2>
<table>
  <tr>
    <th>编译器</th> <th colspan="2">有ccache</th> <th colspan="2">无ccache</th>
  </tr>
  <tr>
    <th>编译器</th> <th>lto=no</th> <th>lto=yes</th> <th>lto=no</th> <th>lto=yes</th>
  </tr>
  <tr>
    <td>clang</td> <td>50s</td> <td>86s</td> <td>83s</td> <td>67s</td>
  </tr>
  <tr>
    <td>gcc</td> <td>59s</td> <td>641s</td> <td>227s</td> <td>630s</td>
  </tr>
</table>
<ul>
<li>
<p><code>clang</code></p>
<ul>
<li>
<p><code>with ccache</code></p>
<ul>
<li>
<p><code>lto=no</code></p>
<ul>
<li><code>视频内数据</code></li>
<li><code>--clang</code> </li>
<li><code>--mingw64</code></li>
<li><code>--lto=no</code></li>
<li>耗时: 50000ms (50s)</li>
<li><img src="clang_mingw_lto_no_ccache.png" alt="clang mingw lto no ccache" /></li>
</ul>
</li>
<li>
<p><code>lto=yes</code></p>
<ul>
<li><code>后期测试数据</code></li>
<li><code>--clang</code> </li>
<li><code>--mingw64</code></li>
<li><code>--lto=yes</code></li>
<li>耗时 86000ms (86s)</li>
<li><img src="clang_mingw_lto_yes_ccache.png" alt="clang mingw lto yes ccache" /></li>
</ul>
</li>
</ul>
</li>
<li>
<p><code>no ccache</code></p>
<ul>
<li>
<p><code>lto=no</code></p>
<ul>
<li><code>视频内数据</code></li>
<li><code>--clang</code></li>
<li><code>--mingw64</code></li>
<li><code>--lto=no</code></li>
<li><code>--disable-ccache</code></li>
<li>耗时 83000ms (83s)</li>
<li><img src="clang_mingw_lto_no.png" alt="clang mingw lto no" /></li>
</ul>
</li>
<li>
<p><code>lto=yes</code></p>
<ul>
<li><code>后期测试数据</code></li>
<li><code>--clang</code></li>
<li><code>--mingw64</code></li>
<li><code>--lto=yes</code></li>
<li><code>--disable-ccache</code></li>
<li>耗时 67000ms (67s)</li>
<li><img src="clang_mingw_lto_yes.png" alt="clang mingw lto yes" /></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p><code>mingw64</code></p>
<ul>
<li>
<p><code>with ccache</code></p>
<ul>
<li>
<p><code>lto=no</code></p>
<ul>
<li><code>后期测试数据</code></li>
<li><code>--mingw64</code></li>
<li><code>--lto=no</code></li>
<li>耗时 59000ms (59s)</li>
<li><img src="mingw_lto_no_ccache.png" alt="mingw lto no ccache" /></li>
</ul>
</li>
<li>
<p><code>lto=yes</code></p>
<ul>
<li><code>后期测试数据</code></li>
<li><code>--mingw64</code></li>
<li><code>--lto=yes</code></li>
<li>耗时 641000ms (641s) (10.68min)</li>
<li><img src="mingw_lto_yes_ccache.png" alt="mingw lto yes ccache" /></li>
</ul>
</li>
</ul>
</li>
<li>
<p><code>no ccache</code></p>
<ul>
<li>
<p><code>lto=no</code></p>
<ul>
<li><code>视频内数据</code></li>
<li><code>--mingw64</code></li>
<li><code>--lto=no</code></li>
<li><code>--disable-ccache</code></li>
<li>耗时 227000ms (227s) (3.78min)</li>
<li><img src="mingw_lto_no.png" alt="mingw lto no" /></li>
</ul>
</li>
<li>
<p><code>lto=yes</code></p>
<ul>
<li><code>后期测试数据</code></li>
<li><code>--mingw64</code></li>
<li><code>--lto=yes</code></li>
<li><code>--disable-ccache</code></li>
<li>耗时 630000ms (630s) (10.5min)</li>
<li><img src="mingw_lto_yes.png" alt="mingw lto yes" /></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../rua!.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../plan_features/index.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../rua!.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../plan_features/index.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script>
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
